CREATE  VIEW `v_actual_problem_links` AS select `problemlink`.`problemID` AS `problemID`,`problemlink`.`problemLinkID` AS `problemLinkID`,`problemlink`.`problemLinkType` AS `problemLinkType`,`problemlink`.`createdDate` AS `createdDate`,`problemlink`.`createdBy` AS `createdBy`,`problemlink`.`deletedDate` AS `deletedDate`,`problemlink`.`deletedBy` AS `deletedBy`,`problem`.`problemHeader` AS `problemLinkName`,`problemlink`.`problemID` AS `id` from (`problemlink` join `problem` on((`problemlink`.`problemLinkID` = `problem`.`problemID`))) where ((`problemlink`.`problemLinkType` = 2) and isnull(`problemlink`.`deletedDate`)) union select `problemlink`.`problemID` AS `problemID`,`problemlink`.`problemLinkID` AS `problemLinkID`,`problemlink`.`problemLinkType` AS `problemLinkType`,`problemlink`.`createdDate` AS `createdDate`,`problemlink`.`createdBy` AS `createdBy`,`problemlink`.`deletedDate` AS `deletedDate`,`problemlink`.`deletedBy` AS `deletedBy`,`project`.`projectName` AS `problemLinkName`,`problemlink`.`problemID` AS `id` from (`problemlink` join `project` on((`problemlink`.`problemLinkID` = `project`.`projectID`))) where ((`problemlink`.`problemLinkType` = 1) and isnull(`problemlink`.`deletedDate`));

CREATE  VIEW `v_board` AS select `brd`.`id` AS `id`,`brd`.`userID` AS `userID`,`brd`.`itemID` AS `itemID`,`brd`.`itemType` AS `itemType`,`brd`.`columnNo` AS `columnNo`,`brd`.`itemOrder` AS `itemOrder`,`tsk`.`taskDescription` AS `description` from (`board` `brd` left join `task` `tsk` on((`brd`.`itemID` = `tsk`.`taskID`))) where (isnull(`tsk`.`deletedDate`) and (`tsk`.`taskStatusID` not in (7,8,9)));

CREATE  VIEW `v_board_queue` AS select `tsk`.`taskID` AS `id`,`tsk`.`taskDescription` AS `description`,`tsk`.`assignedTo` AS `assignedTo`,1 AS `type` from ((`project` `prj` join `tasklist` `tkl` on((`prj`.`projectID` = `tkl`.`taskListID`))) join `task` `tsk` on((`tkl`.`taskListID` = `tsk`.`taskListID`))) where (isnull(`tsk`.`deletedDate`) and (`tsk`.`taskStatusID` not in (7,8,9)) and (not(`tsk`.`taskID` in (select `board`.`itemID` from `board` where ((`board`.`itemType` = 1) and (`board`.`columnNo` <> 1)))))) union select `prb`.`problemID` AS `id`,`prb`.`problemHeader` AS `description`,`prb`.`assignedTo` AS `assignedTo`,2 AS `type` from `problem` `prb` where (isnull(`prb`.`deletedDate`) and (`prb`.`problemStatusID` <> 4) and (not(`prb`.`problemID` in (select `board`.`itemID` from `board` where ((`board`.`itemType` = 2) and (`board`.`columnNo` <> 1))))));

CREATE  VIEW `v_chart_project_behind_tasks` AS select `prj`.`projectID` AS `projectID`,`lk`.`lookupValueChar` AS `status`,count(`tsk`.`taskID`) AS `countTasks`,`tsk`.`deletedDate` AS `deletedDate`,`tsk`.`taskStartDate` AS `taskStartDate`,`tsk`.`taskTimeEstimate` AS `taskTimeEstimate`,`tsk`.`taskID` AS `id` from (((`project` `prj` left join `tasklist` `tsl` on((`prj`.`projectID` = `tsl`.`projectID`))) left join `task` `tsk` on((`tsk`.`taskListID` = `tsl`.`taskListID`))) left join `lookup` `lk` on((`lk`.`lookupValueNum` = `tsk`.`taskStatusID`))) where ((`lk`.`lookupTypeID` = 21) and ((`tsk`.`taskStartDate` + interval `tsk`.`taskTimeEstimate` day) < now()) and (`tsk`.`taskStatusID` not in (7,8,9))) group by `prj`.`projectID`,`lk`.`lookupValueChar`;


CREATE  VIEW `v_client_users` AS select `org`.`clientID` AS `clientID`,`org`.`organisationID` AS `organisationID`,`org`.`organisationName` AS `organisationName`,`usr`.`first_name` AS `first_name`,`usr`.`last_name` AS `last_name`,`usr`.`id` AS `userID` from ((`userorganisation` `uorg` join `users` `usr` on((`uorg`.`organisationID` = `usr`.`company`))) join `organisation` `org` on((`org`.`organisationID` = `uorg`.`organisationID`))) where (isnull(`uorg`.`deletedDate`) and isnull(`org`.`deletedDate`));

CREATE  VIEW `v_comments_parent` AS select `usr`.`first_name` AS `first_name`,`usr`.`last_name` AS `last_name`,`com`.`commentID` AS `commentID`,`com`.`parentID` AS `parentID`,`com`.`parentTypeID` AS `parentTypeID`,`com`.`commentTypeID` AS `commentTypeID`,`com`.`commentText` AS `commentText`,date_format(`com`.`createdDate`,'%a %D %M %Y %l:%i %p') AS `createdDate`,`com`.`createdBy` AS `createdBy`,`lk`.`lookupValueChar` AS `lookupValueChar`,`doc`.`documentFileName` AS `documentFileName`,`doc`.`documentName` AS `documentName`,`doc`.`documentTitle` AS `documenttitle`,`doc`.`documentTypeID` AS `documentTypeID`,`com`.`commentID` AS `id` from (((`comment` `com` join `lookup` `lk` on((`lk`.`lookupValueNum` = `com`.`commentTypeID`))) join `users` `usr` on((`com`.`createdBy` = `usr`.`id`))) left join `document` `doc` on(((`doc`.`documentParentID` = `com`.`commentID`) and (`doc`.`documentTypeID` = 2)))) where (`lk`.`lookupTypeID` = 6);

CREATE  VIEW `v_email_queue` AS select `bf_email_queue`.`to_email` AS `to_email`,`bf_email_queue`.`subject` AS `subject`,`bf_email_queue`.`message` AS `message`,`bf_email_queue`.`date_published` AS `date_published`,`bf_email_queue`.`date_sent` AS `date_sent`,`bf_email_queue`.`success` AS `success` from `bf_email_queue` where (isnull(`bf_email_queue`.`date_sent`) or (`bf_email_queue`.`success` = 0));

CREATE  VIEW `v_importances` AS select `lookup`.`lookupValueNum` AS `importanceID`,`lookup`.`lookupValueChar` AS `importanceName`,`lookup`.`lookupValueNum` AS `id` from `lookup` where ((`lookup`.`lookupTypeID` = 19) and isnull(`lookup`.`deletedDate`));


CREATE  VIEW `v_lookups_by_type` AS select `lookup`.`clientID` AS `clientID`,`lookup`.`lookupTypeID` AS `lookupTypeID`,`lookup`.`lookupSubTypeID` AS `lookupSubTypeID`,`lookup`.`lookupOrder` AS `lookupOrder`,`lookup`.`lookupValueNum` AS `lookupValueNum`,`lookup`.`lookupValueChar` AS `lookupValueChar`,`lookup`.`lookupDescription` AS `lookupDescription`,`lookup`.`createdDate` AS `createdDate`,`lookup`.`createdBy` AS `createdBy`,`lookup`.`updatedDate` AS `updatedDate`,`lookup`.`updatedBy` AS `updatedBy`,`lookup`.`deletedDate` AS `deletedDate`,`lookup`.`deletedBy` AS `deletedBy`,`lookup`.`lookupTypeID` AS `id` from `lookup` where isnull(`lookup`.`deletedDate`);


CREATE  VIEW `v_my_attention_required` AS select distinct 'Task' AS `type`,2 AS `ordercol`,`pr`.`projectName` AS `projectName`,`pr`.`projectID` AS `projectID`,`tk`.`taskDescription` AS `taskDescription`,`tk`.`taskID` AS `itemID`,`tk`.`assignedTo` AS `assignedTo`,`pr`.`organisationID` AS `organisationID`,`tk`.`deletedDate` AS `deletedDate`,`upr`.`userID` AS `userID` from (((`project` `pr` join `tasklist` `tl` on((`pr`.`projectID` = `tl`.`projectID`))) join `task` `tk` on((`tl`.`taskListID` = `tk`.`taskListID`))) join `userproject` `upr` on((`upr`.`projectID` = `pr`.`projectID`))) where ((`tk`.`taskPriorityID` = 2) and isnull(`tk`.`deletedDate`)) union select distinct 'Problem' AS `type`,2 AS `ordercol`,`prb`.`problemHeader` AS `problemHeader`,`prb`.`problemID` AS `problemID`,NULL AS `taskDescription`,`prb`.`problemID` AS `itemID`,`prb`.`assignedTo` AS `assignedTo`,`prb`.`organisationID` AS `organisationID`,`prb`.`deletedDate` AS `deletedDate`,NULL AS `userID` from `problem` `prb` where ((`prb`.`problemPriorityID` = 2) and isnull(`prb`.`deletedDate`));


CREATE  VIEW `v_my_critical_work` AS select distinct 'Task' AS `type`,1 AS `ordercol`,`pr`.`projectName` AS `projectName`,`pr`.`projectID` AS `projectID`,`tk`.`taskDescription` AS `taskDescription`,`tk`.`taskID` AS `itemID`,`tk`.`assignedTo` AS `assignedTo`,`pr`.`organisationID` AS `organisationID`,`tk`.`deletedDate` AS `deletedDate`,`pr`.`projectID` AS `id` from (((`project` `pr` join `tasklist` `tl` on((`pr`.`projectID` = `tl`.`projectID`))) join `task` `tk` on((`tl`.`taskListID` = `tk`.`taskListID`))) join `userproject` `upr` on((`upr`.`projectID` = `pr`.`projectID`))) where ((`tk`.`taskPriorityID` = 1) and (`tk`.`taskStatusID` in (1,2,3,4,5,6,19)) and isnull(`tk`.`deletedDate`)) union select distinct 'Problem' AS `type`,1 AS `ordercol`,`prb`.`problemHeader` AS `problemHeader`,`prb`.`problemID` AS `problemID`,`prb`.`problemDescription` AS `problemDescription`,`prb`.`problemID` AS `itemID`,`prb`.`assignedTo` AS `assignedTo`,`prb`.`organisationID` AS `organisationID`,`prb`.`deletedDate` AS `deletedDate`,`prb`.`problemID` AS `id` from `problem` `prb` where ((`prb`.`problemPriorityID` = 1) and isnull(`prb`.`deletedDate`));


CREATE  VIEW `v_my_invoice_times` AS select `pr`.`projectName` AS `projectName`,`tkl`.`taskListName` AS `taskListName`,`tsk`.`taskDescription` AS `taskDescription`,date_format(`tm`.`timeDay`,'%e %b %Y') AS `timeDay`,`tm`.`hours` AS `hours`,`tm`.`userID` AS `userID`,`tm`.`timeID` AS `timeID`,`tm`.`deletedDate` AS `deletedDate`,`tm`.`timeID` AS `id` from (((`time` `tm` join `task` `tsk` on((`tm`.`taskID` = `tsk`.`taskID`))) join `tasklist` `tkl` on((`tkl`.`taskListID` = `tsk`.`taskListID`))) join `project` `pr` on((`pr`.`projectID` = `tkl`.`projectID`)));


CREATE  VIEW `v_my_org_tasks` AS select distinct `upr`.`userID` AS `userID`,concat(`prj`.`projectName`,' - ',`tsk`.`taskDescription`) AS `taskDescription`,`tsk`.`taskID` AS `taskID`,`tsk`.`deletedDate` AS `deletedDate`,`tsk`.`taskID` AS `id` from (((`task` `tsk` join `tasklist` `tkl`) join `project` `prj`) join `userproject` `upr`) where ((`upr`.`projectID` = `prj`.`projectID`) and (`prj`.`projectID` = `tkl`.`projectID`) and (`tsk`.`taskListID` = `tkl`.`taskListID`));

CREATE  VIEW `v_my_organisation_events` AS select `org`.`organisationName` AS `organisationName`,`org`.`createdDate` AS `createdDate`,`cl`.`userID` AS `userID`,`org`.`organisationID` AS `organisationID`,3 AS `type` from (`organisation` `org` join `client` `cl` on((`org`.`clientID` = `cl`.`clientID`))) where (`org`.`createdDate` > `fn_past_date`(-(10))) union select `org`.`organisationName` AS `organisationName`,`org`.`updatedDate` AS `updatedDate`,`cl`.`userID` AS `userID`,`org`.`organisationID` AS `organisationID`,5 AS `type` from (`organisation` `org` join `client` `cl` on((`org`.`clientID` = `cl`.`clientID`))) where (`org`.`updatedDate` > `fn_past_date`(-(10))) union select `org`.`organisationName` AS `organisationName`,`org`.`createdDate` AS `createdDate`,`cl`.`userID` AS `userID`,`org`.`organisationID` AS `organisationID`,7 AS `type` from (`organisation` `org` join `client` `cl` on((`org`.`clientID` = `cl`.`clientID`))) where (`org`.`updatedDate` > `fn_past_date`(-(10)));


CREATE  VIEW `v_my_problems` AS select `pro`.`problemID` AS `problemID`,`pro`.`organisationID` AS `organisationID`,`lookty`.`lookupDescription` AS `problemType`,`pro`.`problemHeader` AS `problemHeader`,`pro`.`assignedTo` AS `assignedTo`,`looksc`.`lookupDescription` AS `problemScope`,`lookstat`.`lookupDescription` AS `problemStatus`,`lookpr`.`lookupDescription` AS `problemPriority`,`looksc`.`lookupValueNum` AS `problemScopeID`,`pro`.`createdBy` AS `createdBy`,`pro`.`problemID` AS `id` from ((((`problem` `pro` left join `lookup` `lookty` on((`pro`.`problemTypeID` = `lookty`.`lookupSubTypeID`))) left join `lookup` `looksc` on((`pro`.`scope` = `looksc`.`lookupSubTypeID`))) left join `lookup` `lookstat` on((`pro`.`problemStatusID` = `lookstat`.`lookupSubTypeID`))) left join `lookup` `lookpr` on((`pro`.`problemPriorityID` = `lookpr`.`lookupSubTypeID`))) where ((`lookty`.`lookupTypeID` = 8) and (`looksc`.`lookupTypeID` = 10) and (`lookstat`.`lookupTypeID` = 11) and (`lookpr`.`lookupTypeID` = 12) and isnull(`pro`.`deletedBy`));


CREATE  VIEW `v_my_reports` AS select `lk`.`lookupValueNum` AS `lookupValueNum`,`lk`.`lookupValueChar` AS `lookupValueChar`,`usrr`.`userID` AS `userID`,`usrr`.`deletedDate` AS `deletedDate` from (`userreport` `usrr` join `lookup` `lk` on((`usrr`.`reportID` = `lk`.`lookupValueNum`))) where (isnull(`lk`.`deletedDate`) and (`lk`.`lookupTypeID` = 15));


CREATE  VIEW `v_my_tasks` AS select `project`.`projectID` AS `projectID`,`project`.`projectName` AS `projectName`,`tasklist`.`taskListID` AS `taskListID`,`tasklist`.`taskListName` AS `taskListName`,`task`.`taskID` AS `taskID`,`task`.`taskDescription` AS `taskDescription`,`task`.`assignedTo` AS `assignedTo`,`task`.`deletedDate` AS `deletedDate`,`task`.`taskID` AS `id`,`task`.`clientID` AS `clientID`,`task`.`name` AS `name` from ((`task` join `tasklist` on((`task`.`taskListID` = `tasklist`.`taskListID`))) join `project` on((`project`.`projectID` = `tasklist`.`projectID`)));


CREATE  VIEW `v_my_time` AS select `time`.`timeID` AS `timeID`,date_format(`time`.`timeDay`,'%Y %b %d') AS `timeDay`,`time`.`timeDay` AS `timeDayraw`,`time`.`hours` AS `hours`,`time`.`taskID` AS `taskID`,`time`.`timeTypeID` AS `timeTypeID`,`time`.`userID` AS `userID`,`users`.`first_name` AS `first_name`,`users`.`last_name` AS `last_name`,`time`.`deletedDate` AS `deletedDate`,`time`.`comments` AS `comments`,`task`.`taskDescription` AS `taskDescription`,`lookup`.`lookupValueChar` AS `lookupValueChar`,`time`.`timeID` AS `id` from (((`time` join `users` on((`time`.`userID` = `users`.`id`))) join `task` on((`time`.`taskID` = `task`.`taskID`))) join `lookup` on((`time`.`timeTypeID` = `lookup`.`lookupValueNum`))) where (`lookup`.`lookupTypeID` = 13);

CREATE  VIEW `v_my_timesheet` AS select `time`.`timeID` AS `timeID`,`time`.`timeDay` AS `timeday`,date_format(`time`.`timeDay`,'%e %b %Y') AS `timeDayF`,`task`.`taskDescription` AS `taskDescription`,sum(`time`.`hours`) AS `hours`,`users`.`id` AS `userID`,`time`.`timeTypeID` AS `timetypeID`,`lookup`.`lookupTypeID` AS `lookupTypeID`,`time`.`timeID` AS `id` from (((`time` join `users` on((`time`.`userID` = `users`.`id`))) join `task` on((`time`.`taskID` = `task`.`taskID`))) join `lookup` on(((`time`.`timeTypeID` = `lookup`.`lookupValueNum`) and (`lookup`.`lookupTypeID` = 13)))) group by `users`.`id`,date_format(`time`.`timeDay`,'%e %b %Y'),`task`.`taskDescription` with rollup;

CREATE  VIEW `v_my_users` AS select distinct `usr`.`id` AS `user_id`,`usr`.`first_name` AS `first_name`,`usr`.`last_name` AS `last_name`,`org`.`organisationID` AS `organisationID`,`org`.`organisationName` AS `organisationName`,`usr`.`active` AS `active`,concat(`usr`.`first_name`,' ',`usr`.`last_name`) AS `name`,`uo`.`userID` AS `userID`,if((`usr`.`active` = 1),'Yes','No') AS `activeDesc`,`usr`.`id` AS `id` from ((`organisation` `org` join `userorganisation` `uo` on((`org`.`organisationID` = `uo`.`organisationID`))) join `users` `usr` on((`org`.`organisationID` = `usr`.`company`))) union select distinct `usr`.`id` AS `user_id`,`usr`.`first_name` AS `first_name`,`usr`.`last_name` AS `last_name`,`org`.`organisationID` AS `organisationID`,`org`.`organisationName` AS `organisationName`,`usr`.`active` AS `active`,concat(`usr`.`first_name`,' ',`usr`.`last_name`) AS `name`,`usr`.`id` AS `userID`,if((`usr`.`active` = 1),'Yes','No') AS `activeDesc`,`usr`.`id` AS `id` from (`organisation` `org` join `users` `usr` on((`org`.`organisationID` = `usr`.`company`)));


CREATE  VIEW `v_organisation_project_managers` AS select `org`.`organisationID` AS `organisationID`,`org`.`organisationName` AS `organisationName`,`usr`.`id` AS `userID`,`usr`.`first_name` AS `first_name`,`usr`.`last_name` AS `last_name`,`proj`.`projectID` AS `projectID`,`proj`.`projectName` AS `projectName`,`usr`.`id` AS `id` from (((`userorganisation` `uorg` join `users` `usr` on((`uorg`.`organisationID` = `usr`.`company`))) join `organisation` `org` on((`org`.`organisationID` = `uorg`.`organisationID`))) join `project` `proj` on((`org`.`organisationID` = `proj`.`organisationID`))) where (isnull(`uorg`.`deletedDate`) and isnull(`org`.`deletedDate`));

CREATE  VIEW `v_organisation_project_users` AS select `org`.`organisationID` AS `organisationID`,`org`.`organisationName` AS `organisationName`,`usr`.`id` AS `userID`,`usr`.`first_name` AS `first_name`,`usr`.`last_name` AS `last_name`,`proj`.`projectID` AS `projectID`,`proj`.`projectName` AS `projectName`,`usr`.`id` AS `id` from (((`userorganisation` `uorg` join `users` `usr` on((`uorg`.`organisationID` = `usr`.`company`))) join `organisation` `org` on((`org`.`organisationID` = `uorg`.`organisationID`))) join `project` `proj` on((`org`.`organisationID` = `proj`.`organisationID`))) where (isnull(`uorg`.`deletedDate`) and isnull(`org`.`deletedDate`) and (not(`usr`.`id` in (select `upr`.`userID` from `userproject` `upr` where (`upr`.`projectID` = `proj`.`projectID`)))));

CREATE  VIEW `v_organisation_users` AS select `org`.`organisationID` AS `organisationID`,`org`.`organisationName` AS `organisationName`,`usr`.`first_name` AS `first_name`,`usr`.`last_name` AS `last_name`,`usr`.`id` AS `id`,`org`.`clientID` AS `clientid`,`usr`.`company` AS `company`,`org`.`createdBy` AS `createdby`,`usr`.`id` AS `userid`,'y' AS `orgu` from (((`organisation` `org` join `userorganisation` `uorg` on((`org`.`organisationID` = `uorg`.`organisationID`))) join `users` `usr` on((`uorg`.`userID` = `usr`.`id`))) join `auth_user` `ausr` on((`usr`.`id` = `ausr`.`id`))) where (isnull(`uorg`.`deletedDate`) and isnull(`org`.`deletedDate`) and (`ausr`.`is_active` = 1)) union select `org`.`organisationID` AS `organisationID`,`org`.`organisationName` AS `organisationName`,`ausr`.`first_name` AS `first_name`,`ausr`.`last_name` AS `last_name`,`ausr`.`id` AS `id`,`org`.`clientID` AS `clientid`,`usr`.`company` AS `company`,`org`.`createdBy` AS `createdby`,`ausr`.`id` AS `userid`,'n' AS `orgu` from ((`organisation` `org` join `users` `usr` on(((`usr`.`company` = `org`.`organisationID`) or (`usr`.`id` = `org`.`createdBy`)))) join `auth_user` `ausr` on((`ausr`.`id` = `usr`.`id`))) where ((`org`.`createdBy` = `usr`.`id`) and isnull(`org`.`deletedDate`) and (`ausr`.`is_active` = 1));


CREATE  VIEW `v_problem_json` AS select concat('[',group_concat(concat('{problemHeader:\'',`problem`.`problemHeader`,'\''),concat(',problemID:\'',`problem`.`problemID`,'\'}') separator ','),']') AS `Name_exp_1` from `problem`;

CREATE  VIEW `v_project_detail` AS select distinct `project`.`projectID` AS `projectID`,`project`.`organisationID` AS `organisationID`,`project`.`programmeID` AS `programmeID`,`project`.`clientID` AS `clientID`,`project`.`projectName` AS `projectName`,`project`.`projectDescription` AS `projectDescription`,`project`.`stakeholderID` AS `stakeholderID`,`project`.`projectManagerID` AS `projectManagerID`,`project`.`deliverables` AS `deliverables`,`project`.`budget` AS `budget`,`project`.`importance` AS `importance`,`project`.`createdDate` AS `createdDate`,`project`.`createdBy` AS `createdBy`,`project`.`updatedDate` AS `updatedDate`,`project`.`updatedBy` AS `updatedBy`,`project`.`deletedDate` AS `deletedDate`,`project`.`deletedBy` AS `deletedBy`,`org`.`organisationName` AS `organisationName`,`usr`.`first_name` AS `shFirstName`,`usr`.`last_name` AS `shLastName`,`lk`.`lookupValueChar` AS `importanceDescription`,`usr2`.`first_name` AS `pmFirstName`,`usr2`.`last_name` AS `pmLastName`,`usr3`.`id` AS `userID`,`project`.`projectID` AS `id` from ((((((`project` join `userproject` `upr` on((`project`.`projectID` = `upr`.`projectID`))) join `users` `usr3` on((`upr`.`userID` = `usr3`.`id`))) left join `organisation` `org` on((`project`.`organisationID` = `org`.`organisationID`))) left join `users` `usr` on((`project`.`stakeholderID` = `usr`.`id`))) left join `lookup` `lk` on(((`project`.`importance` = `lk`.`lookupSubTypeID`) and (`lk`.`lookupTypeID` = 19)))) left join `users` `usr2` on((`project`.`projectManagerID` = `usr2`.`id`))) where isnull(`project`.`deletedDate`);

CREATE  VIEW `v_project_documents` AS select `document`.`documentID` AS `documentID`,`document`.`documentTypeID` AS `documentTypeID`,`document`.`documentParentID` AS `documentParentID`,`document`.`documentName` AS `documentName`,`document`.`documentFileName` AS `documentFileName`,`document`.`documentTitle` AS `documentTitle`,`document`.`createdDate` AS `createdDate`,`document`.`createdBy` AS `createdBy`,`document`.`deletedDate` AS `deletedDate`,`document`.`deletedBy` AS `deletedBy`,`document`.`documentID` AS `id` from `document` where ((`document`.`documentTypeID` = 1) and isnull(`document`.`deletedDate`));

CREATE  VIEW `v_project_gantt` AS select `prj`.`projectID` AS `projectID`,`prj`.`projectName` AS `projectName`,`prj`.`projectDescription` AS `projectDescription`,`prj`.`updatedDate` AS `updatedDate`,`prj`.`updatedBy` AS `updatedBy`,`tsl`.`taskListID` AS `taskListID`,`tsl`.`taskListName` AS `taskListName`,`tsl`.`taskListDescription` AS `taskListDescription`,`tsk`.`taskID` AS `taskID`,`tsk`.`taskDescription` AS `taskDescription`,`prj`.`deletedDate` AS `deletedDate`,ifnull(`tsk`.`taskStartDate`,(now() - interval 30 day)) AS `taskStartDate`,`tsk`.`assignedTo` AS `assignedTo`,(`tsk`.`taskStartDate` + interval `tsk`.`taskTimeEstimate` day) AS `taskEndDate`,ifnull(`tsk`.`taskTimeEstimate`,1) AS `taskTimeEstimate`,`tsk`.`taskPercentComplete` AS `taskpercentcomplete`,`tsk`.`taskID` AS `id`,`tsk`.`deletedDate` AS `taskDeletedDate` from ((`project` `prj` join `tasklist` `tsl` on((`prj`.`projectID` = `tsl`.`projectID`))) join `task` `tsk` on((`tsk`.`taskListID` = `tsl`.`taskListID`))) where (`tsk`.`taskStartDate` is not null) order by `tsl`.`taskListID`,`tsk`.`assignedTo`,`tsk`.`taskStartDate`;

CREATE  VIEW `v_project_opinion` AS select `opinion`.`opinionID` AS `opinionID`,`project`.`projectID` AS `projectID`,`opinion`.`userID` AS `userID`,`opinion`.`itemID` AS `itemID`,`opinion`.`itemType` AS `itemType`,`opinion`.`opinionType` AS `opinionType`,`opinion`.`opinion` AS `opinion` from (`project` join `opinion` on((`project`.`projectID` = `opinion`.`itemID`))) where isnull(`opinion`.`deletedDate`);

CREATE  VIEW `v_project_opinion_detail` AS select `opinion`.`opinionID` AS `opinionID`,`project`.`projectID` AS `projectID`,`opinion`.`userID` AS `userID`,`opinion`.`itemID` AS `itemID`,`opinion`.`itemType` AS `itemType`,`opinion`.`opinionType` AS `opinionType`,`lk`.`lookupValueChar` AS `opinionDescription`,concat(`usr`.`first_name`,' ',`usr`.`last_name`) AS `userName`,`opinion`.`opinionID` AS `id` from (((`project` join `opinion` on((`project`.`projectID` = `opinion`.`itemID`))) join `lookup` `lk` on(((`lk`.`lookupSubTypeID` = `opinion`.`opinionType`) and (`lk`.`lookupTypeID` = 20)))) join `users` `usr` on((`opinion`.`userID` = `usr`.`id`))) where isnull(`opinion`.`deletedDate`);

CREATE  VIEW `v_project_tasks` AS select distinct `pr`.`projectID` AS `projectID`,`pr`.`projectName` AS `projectName`,`pr`.`projectDescription` AS `projectDescription`,`tl`.`taskListID` AS `taskListID`,`tl`.`taskListName` AS `taskListName`,`tl`.`taskListDescription` AS `taskListDescription`,`tk`.`taskID` AS `taskID`,`tk`.`name` AS `name`,`tk`.`taskDescription` AS `taskDescription`,concat(left(`tk`.`taskDescription`,80),'...') AS `taskDescriptionShort`,`tk`.`taskTypeID` AS `taskTypeID`,`tk`.`taskStatusID` AS `taskStatusID`,`tk`.`taskPriorityID` AS `taskPriorityID`,`tk`.`assignedTo` AS `assignedTo`,`lkst`.`lookupValueChar` AS `taskStatus`,`lkpr`.`lookupValueChar` AS `taskPriority`,`tk`.`taskID` AS `id`,`pr`.`clientID` AS `clientID`,`tk`.`createdBy` AS `taskCreatedBy`,`tk`.`deletedBy` AS `task_deleted_by`,`tl`.`deletedBy` AS `tasklist_deleted_by` from ((((`project` `pr` join `tasklist` `tl` on((`pr`.`projectID` = `tl`.`projectID`))) left join `task` `tk` on((`tl`.`taskListID` = `tk`.`taskListID`))) left join `lookup` `lkst` on(((`tk`.`taskStatusID` = `lkst`.`lookupValueNum`) and (`lkst`.`lookupTypeID` = 21)))) left join `lookup` `lkpr` on(((`tk`.`taskPriorityID` = `lkpr`.`lookupValueNum`) and (`lkpr`.`lookupTypeID` = 4))));


CREATE  VIEW `v_projectgantt_jq` AS select `prj`.`projectID` AS `projectID`,`prj`.`projectName` AS `projectName`,`prj`.`projectDescription` AS `projectDescription`,`prj`.`updatedDate` AS `updatedDate`,`prj`.`updatedBy` AS `updatedBy`,`tsl`.`taskListID` AS `taskListID`,`tsl`.`taskListName` AS `taskListName`,`tsl`.`taskListDescription` AS `taskListDescription`,`tsk`.`taskID` AS `taskID`,`tsk`.`taskDescription` AS `taskDescription`,ifnull(`tsk`.`taskLinkID`,`tsk`.`taskID`) AS `taskOrderID`,`prj`.`deletedDate` AS `deletedDate`,ifnull((unix_timestamp((`tsk2`.`taskStartDate` + interval `tsk2`.`taskTimeEstimate` day)) * 1000),ifnull((unix_timestamp(`tsk`.`taskStartDate`) * 1000),(unix_timestamp(`tsk`.`createdDate`) * 1000))) AS `taskStartDate`,`tsk`.`assignedTo` AS `assignedTo`,(unix_timestamp((`tsk`.`taskStartDate` + interval `tsk`.`taskTimeEstimate` day)) * 1000) AS `taskEndDate`,`tsk`.`taskTimeEstimate` AS `taskTimeEstimate`,`tsk`.`taskStartDate` AS `taskStartDate_unformatted`,`tsk`.`taskTimeEstimate` AS `time_estimate`,`tsk`.`taskID` AS `id` from (((`project` `prj` join `tasklist` `tsl` on((`prj`.`projectID` = `tsl`.`projectID`))) join `task` `tsk` on((`tsk`.`taskListID` = `tsl`.`taskListID`))) left join `task` `tsk2` on((`tsk`.`taskID` = `tsk2`.`taskLinkID`))) where isnull(`tsk`.`deletedDate`) order by `prj`.`projectID`,ifnull(`tsk`.`taskLinkID`,`tsk`.`taskID`),`tsk`.`taskListID`,`tsk`.`assignedTo`,`tsk`.`taskStartDate`;


CREATE  VIEW `v_schedule` AS select `phs`.`phaseID` AS `phaseID`,`phs`.`phaseName` AS `phaseName`,`phs`.`phaseDescription` AS `phaseDescription`,`phs`.`startDate` AS `startdate`,`tsk`.`name` AS `name`,`tsk`.`taskID` AS `taskID`,`tsk`.`assignedTo` AS `assignedTo`,`phs`.`phaseID` AS `id`,`phs`.`clientID` AS `clientid` from (`phase` `phs` left join `task` `tsk` on((`phs`.`phaseID` = `tsk`.`phaseID`))) where (isnull(`tsk`.`deletedDate`) and isnull(`phs`.`deletedDate`) and ((`tsk`.`taskStatusID` not in (7,8,9)) or isnull(`tsk`.`taskStatusID`)));


CREATE  VIEW `v_subscribers_recent` AS select `acc`.`accountName` AS `accountName`,`acc`.`authenticationID` AS `authenticationID`,`acc`.`authenticationID2` AS `authenticationID2`,`acc`.`authenticationID3` AS `authenticationID3`,`cli`.`clientName` AS `clientName`,`cli`.`city` AS `city`,`cli`.`country` AS `country`,`acc`.`createdDate` AS `createdDate` from (`account` `acc` left join `client` `cli` on((`acc`.`accountID` = `cli`.`accountID`))) where (`acc`.`createdDate` > (curdate() - interval 28 day));

CREATE  VIEW `v_task_detail` AS select `tsk`.`taskID` AS `taskID`,`tsk`.`name` AS `name`,`tsk`.`taskDescription` AS `taskDescription`,`tsk`.`taskTypeID` AS `taskTypeID`,`lkpr`.`lookupValueChar` AS `taskPriority`,`lkst`.`lookupValueChar` AS `taskStatus`,`lkpr`.`lookupValueNum` AS `taskPriorityID`,`lkst`.`lookupValueNum` AS `taskStatusID`,`tsk`.`assignedTo` AS `assignedTo`,concat(`usr`.`first_name`,' ',`usr`.`last_name`) AS `assignedToName`,date_format(`tsk`.`taskStartDate`,'%Y/%m/%d') AS `taskStartDate`,`tsk`.`taskTimeEstimate` AS `taskTimeEstimate`,`tsk`.`taskPercentComplete` AS `taskPercentComplete`,`tsk`.`taskLinkID` AS `taskLinkID`,`tsk2`.`taskID` AS `linkedTaskID`,`tsk2`.`taskDescription` AS `linkedTaskDescription`,`upr`.`userID` AS `userID`,`prj`.`projectName` AS `projectName`,`tkl`.`taskListName` AS `tasklistName`,`tkl`.`taskListID` AS `taskListID`,date_format(`tsk`.`completionDate`,'%Y/%m/%d') AS `completionDate`,`tsk`.`phaseID` AS `phaseID`,`phs`.`phaseName` AS `phaseName`,`tsk`.`taskID` AS `id`,`tsk`.`clientID` AS `clientID` from ((((((((`task` `tsk` join `tasklist` `tkl` on((`tkl`.`taskListID` = `tsk`.`taskListID`))) join `project` `prj` on((`prj`.`projectID` = `tkl`.`projectID`))) join `userproject` `upr` on((`upr`.`projectID` = `prj`.`projectID`))) left join `lookup` `lkpr` on(((`tsk`.`taskPriorityID` = `lkpr`.`lookupValueNum`) and (`lkpr`.`lookupTypeID` = 4)))) left join `lookup` `lkst` on(((`tsk`.`taskStatusID` = `lkst`.`lookupValueNum`) and (`lkst`.`lookupTypeID` = 21)))) left join `users` `usr` on((`tsk`.`assignedTo` = `usr`.`id`))) left join `task` `tsk2` on((`tsk`.`taskLinkID` = `tsk2`.`taskID`))) left join `phase` `phs` on((`tsk`.`phaseID` = `phs`.`phaseID`)));

CREATE  VIEW `v_task_documents` AS select `document`.`documentID` AS `documentID`,`document`.`documentTypeID` AS `documentTypeID`,`document`.`documentParentID` AS `documentParentID`,`document`.`documentName` AS `documentName`,`document`.`documentFileName` AS `documentFileName`,`document`.`documentTitle` AS `documentTitle`,`document`.`createdDate` AS `createdDate`,`document`.`createdBy` AS `createdBy`,`document`.`deletedDate` AS `deletedDate`,`document`.`deletedBy` AS `deletedBy`,`document`.`documentID` AS `id` from `document` where ((`document`.`documentTypeID` = 3) and isnull(`document`.`deletedDate`));

CREATE  VIEW `v_task_links` AS select distinct `tk`.`taskID` AS `taskID`,`tkl`.`taskListID` AS `taskListID`,`tk2`.`taskID` AS `taskIDIn`,`tkl2`.`taskListID` AS `taskListIDIn`,concat(left(`tk`.`taskDescription`,20),'...') AS `taskDescription`,`tk`.`taskID` AS `id` from ((((`task` `tk` join `tasklist` `tkl` on((`tk`.`taskListID` = `tkl`.`taskListID`))) join `project` `pr` on((`tkl`.`projectID` = `pr`.`projectID`))) join `tasklist` `tkl2` on((`tkl2`.`projectID` = `pr`.`projectID`))) join `task` `tk2` on((`tk2`.`taskListID` = `tkl2`.`taskListID`))) where (isnull(`pr`.`deletedDate`) and isnull(`tkl`.`deletedDate`) and isnull(`tk`.`deletedDate`));


CREATE  VIEW `v_tasklist_activity` AS select `tkl`.`taskListID` AS `taskListID`,`tkl`.`createdDate` AS `date`,`tkl`.`createdBy` AS `userID`,concat(`usr`.`first_name`,' ',`usr`.`last_name`) AS `name`,'Created' AS `activity` from (`tasklist` `tkl` join `users` `usr` on((`usr`.`id` = `tkl`.`createdBy`))) union select `tkl`.`taskListID` AS `taskListID`,`tkl`.`updatedDate` AS `date`,`tkl`.`updatedBy` AS `userID`,concat(`usr`.`first_name`,' ',`usr`.`last_name`) AS `name`,'Last Updated' AS `activity` from (`tasklist` `tkl` join `users` `usr` on((`usr`.`id` = `tkl`.`updatedBy`))) union select `bf`.`itemID` AS `taskListID`,`bf`.`created_on` AS `date`,`bf`.`user_id` AS `userID`,concat(`usr`.`first_name`,' ',`usr`.`last_name`) AS `name`,'Updated' AS `activity` from (`bf_activities` `bf` join `users` `usr` on((`usr`.`id` = `bf`.`user_id`))) where (`bf`.`itemID` = 3);

CREATE  VIEW `v_tasklist_task` AS select `tkl`.`taskListID` AS `taskListID`,`tkl`.`taskListName` AS `taskListName`,`tkl`.`taskListDescription` AS `taskListDescription`,`tkl`.`clientID` AS `clientID`,`tsk`.`taskID` AS `taskID`,`tsk`.`taskDescription` AS `taskDescription`,concat(left(`tsk`.`taskDescription`,80),'...') AS `taskName`,`tsk`.`taskPriorityID` AS `taskPriorityID`,`tsk`.`taskStatusID` AS `taskStatusID`,`lk`.`lookupValueChar` AS `taskStatus`,`lk2`.`lookupValueChar` AS `taskPriority` from (((`tasklist` `tkl` join `task` `tsk` on((`tkl`.`taskListID` = `tsk`.`taskListID`))) left join `lookup` `lk` on((`tsk`.`taskStatusID` = `lk`.`lookupSubTypeID`))) left join `lookup` `lk2` on((`tsk`.`taskPriorityID` = `lk2`.`lookupSubTypeID`))) where ((`lk`.`lookupTypeID` = 21) and (`lk2`.`lookupTypeID` = 4));

CREATE  VIEW `v_time_calendar` AS select `ti`.`timeID` AS `id`,`tk`.`taskDescription` AS `title`,date_format(`ti`.`timeDay`,'%Y %m %d') AS `start`,`ti`.`timeID` AS `url`,`tk`.`assignedTo` AS `assignedTo`,`ti`.`userID` AS `userID` from (`time` `ti` join `task` `tk` on((`ti`.`taskID` = `tk`.`taskID`)));

CREATE  VIEW `v_time_detail` AS select `time`.`timeID` AS `timeID`,date_format(`time`.`timeDay`,'%d %b %Y') AS `timeDay`,`time`.`hours` AS `hours`,`time`.`taskID` AS `taskID`,`time`.`timeTypeID` AS `timeTypeID`,`time`.`userID` AS `userID`,`task`.`taskDescription` AS `taskDescription`,`lookup`.`lookupValueChar` AS `lookupValueChar`,`users`.`first_name` AS `first_name`,`users`.`last_name` AS `last_name`,`time`.`comments` AS `comments`,`time`.`timeID` AS `id` from (((`time` join `task` on((`time`.`taskID` = `task`.`taskID`))) join `lookup` on((`time`.`timeTypeID` = `lookup`.`lookupValueNum`))) join `users` on((`time`.`userID` = `users`.`id`))) where (`lookup`.`lookupTypeID` = 13);

CREATE  VIEW `v_time_grid` AS select distinct `pr`.`projectName` AS `project`,`pr`.`projectID` AS `projectid`,`tl`.`taskListName` AS `tasklist`,`tl`.`taskListID` AS `tasklistid`,`ti`.`timeID` AS `id`,`tk`.`taskDescription` AS `task`,`tk`.`taskID` AS `taskid`,`ti`.`timeDay` AS `timeDay`,cast(`ti`.`timeDay` as date) AS `timeDayDate`,date_format(`ti`.`timeDay`,'%H') AS `starthour`,date_format(`ti`.`timeDay`,'%i') AS `startmin`,truncate(`ti`.`hours`,0) AS `hours`,(`ti`.`hours` - truncate(`ti`.`hours`,0)) AS `mins`,((`ti`.`hours` - truncate(`ti`.`hours`,0)) * 60) AS `minsformat`,`tk`.`assignedTo` AS `assignedTo` from (((`time` `ti` join `task` `tk` on((`ti`.`taskID` = `tk`.`taskID`))) join `tasklist` `tl` on((`tl`.`taskListID` = `tk`.`taskListID`))) join `project` `pr` on((`pr`.`projectID` = `tl`.`projectID`)));

CREATE  VIEW `v_time_task` AS select `pr`.`projectName` AS `project`,`pr`.`projectID` AS `projectid`,`tl`.`taskListName` AS `tasklist`,`tl`.`taskListID` AS `tasklistid`,left(`tk`.`taskDescription`,50) AS `task`,`tk`.`taskID` AS `taskid`,`tk`.`assignedTo` AS `assignedTo`,`tk`.`taskID` AS `id` from ((`task` `tk` join `tasklist` `tl` on((`tl`.`taskListID` = `tk`.`taskListID`))) join `project` `pr` on((`pr`.`projectID` = `tl`.`projectID`)));

CREATE  VIEW `v_time_type` AS select `lookup`.`lookupValueNum` AS `lookupValueNum`,`lookup`.`lookupValueChar` AS `lookupValueChar`,`lookup`.`clientID` AS `clientID`,`lookup`.`lookupValueNum` AS `id` from `lookup` where (isnull(`lookup`.`deletedDate`) and (`lookup`.`lookupTypeID` = 13));

CREATE  VIEW `v_user_current_projects` AS select `upr`.`userID` AS `userID`,`proj`.`projectID` AS `projectID`,`proj`.`projectName` AS `projectName`,`upr`.`userID` AS `id` from (`userproject` `upr` join `project` `proj` on((`upr`.`projectID` = `proj`.`projectID`))) where (isnull(`upr`.`deletedDate`) and isnull(`proj`.`deletedDate`));


CREATE  VIEW `v_user_potential_projects` AS select `org`.`organisationID` AS `organisationID`,`org`.`organisationName` AS `organisationName`,`usr`.`id` AS `userID`,`usr`.`first_name` AS `first_name`,`usr`.`last_name` AS `last_name`,`proj`.`projectID` AS `projectID`,`proj`.`projectName` AS `projectName` from (((`userorganisation` `uorg` join `users` `usr` on((`uorg`.`organisationID` = `usr`.`company`))) join `organisation` `org` on((`org`.`organisationID` = `uorg`.`organisationID`))) join `project` `proj` on((`org`.`organisationID` = `proj`.`organisationID`))) where (isnull(`uorg`.`deletedDate`) and isnull(`org`.`deletedDate`) and (not(`proj`.`projectID` in (select `upr`.`projectID` from `userproject` `upr` where (`upr`.`userID` = `usr`.`id`)))));

CREATE  VIEW `v_user_projects` AS select `uorg`.`userID` AS `userID`,`uorg`.`organisationID` AS `organisationID`,`proj`.`projectID` AS `projectID`,`proj`.`projectName` AS `projectName` from (`userorganisation` `uorg` join `project` `proj` on((`uorg`.`organisationID` = `proj`.`organisationID`))) where (isnull(`uorg`.`deletedDate`) and isnull(`proj`.`deletedDate`));

CREATE  VIEW `vw_select_organisation_detail_sidebar` AS select 'Created:' AS `description`,date_format(`org`.`createdDate`,'%d %b %Y') AS `column2`,'' AS `id`,0 AS `column4`,`org`.`organisationID` AS `organisationID` from `organisation` `org` union select 'Last changed:' AS `description`,date_format(`org`.`createdDate`,'%d %b %Y') AS `column2`,'' AS `id`,3 AS `column4`,`org`.`organisationID` AS `organisationID` from `organisation` `org` union select 'Organisation projects' AS `Organisation projects`,'' AS `column2`,'' AS `id`,5 AS `5`,'' AS `organisationID` union select `prj`.`projectName` AS `projectName`,concat('Created: ',date_format(`prj`.`createdDate`,'%d %b %Y')) AS `concat ('Created: ', prj.createdDate)`,`prj`.`projectID` AS `projectID`,7 AS `7`,`org`.`organisationID` AS `organisationID` from (`organisation` `org` join `project` `prj` on((`prj`.`organisationID` = `org`.`organisationID`))) order by `column4` limit 40;

CREATE  VIEW `vw_select_organisation_index_sidebar` AS select 'New organisations' AS `organisationName`,'' AS `column2`,'' AS `id`,0 AS `column4`,'' AS `userID` union select `org`.`organisationName` AS `organisationName`,`org`.`createdDate` AS `createdDate`,`org`.`organisationID` AS `id`,3 AS `3`,`usr`.`id` AS `userID` from ((`organisation` `org` join `client` `cl` on((`org`.`clientID` = `cl`.`clientID`))) join `users` `usr` on((`usr`.`company` = `org`.`organisationID`))) where (`org`.`createdDate` > `FN_PAST_DATE`(10)) union select 'Changed organisations' AS `Changed organisations`,'' AS `column2`,'' AS `id`,5 AS `5`,'' AS `userID` union select `org`.`organisationName` AS `organisationName`,`org`.`updatedDate` AS `updatedDate`,`org`.`organisationID` AS `id`,7 AS `7`,`usr`.`id` AS `userID` from ((`organisation` `org` join `client` `cl` on((`org`.`clientID` = `cl`.`clientID`))) join `users` `usr` on((`usr`.`company` = `org`.`organisationID`))) where (`org`.`updatedDate` > `FN_PAST_DATE`(10)) union select 'New users' AS `New users`,'' AS `column2`,'' AS `id`,9 AS `9`,'' AS `userID` union select `org`.`organisationName` AS `organisationName`,`usr`.`username` AS `username`,`org`.`organisationID` AS `id`,11 AS `11`,`usr`.`id` AS `userID` from ((`organisation` `org` join `client` `cl` on((`org`.`clientID` = `cl`.`clientID`))) join `users` `usr` on((`org`.`organisationID` = `usr`.`company`))) where (`usr`.`created_on` > `FN_PAST_DATE`(10)) union select 'New projects' AS `New projects`,'' AS `column2`,'' AS `id`,13 AS `13`,'' AS `userID` union select `org`.`organisationName` AS `organisationName`,`prj`.`projectName` AS `projectName`,`org`.`organisationID` AS `id`,15 AS `15`,`usr`.`id` AS `userID` from (((`organisation` `org` join `client` `cl` on((`org`.`clientID` = `cl`.`clientID`))) join `users` `usr` on((`org`.`organisationID` = `usr`.`company`))) join `project` `prj` on((`prj`.`organisationID` = `org`.`organisationID`))) where (`usr`.`created_on` > `FN_PAST_DATE`(10)) order by `column4` limit 40;

CREATE  VIEW `vw_select_problem_detail_sidebar` AS select 'Created:' AS `description`,date_format(`prob`.`createdDate`,'%d %b %Y') AS `column2`,'' AS `id`,0 AS `column4`,`prob`.`problemID` AS `problemID` from `problem` `prob` union select 'Last changed:' AS `description`,date_format(`prob`.`createdDate`,'%d %b %Y') AS `column2`,'' AS `id`,3 AS `column4`,`prob`.`problemID` AS `problemID` from `problem` `prob` order by `column4`;

CREATE  VIEW `vw_select_problem_index_sidebar` AS select 'New problems' AS `problemName`,'' AS `column2`,'' AS `id`,0 AS `column4`,'' AS `userID` union select distinct `prob`.`problemHeader` AS `problemHeader`,date_format(`prob`.`createdDate`,'%d %b %Y') AS `createdDate`,`prob`.`problemID` AS `problemID`,3 AS `3`,`uorg`.`userID` AS `userID` from (`problem` `prob` join `userorganisation` `uorg` on((`prob`.`organisationID` = `uorg`.`organisationID`))) where (`prob`.`createdDate` > `fn_past_date`(-(10))) union select 'Changed problems' AS `Changed problems`,'' AS `column2`,'' AS `id`,5 AS `5`,'' AS `userID` union select `prob`.`problemHeader` AS `problemHeader`,date_format(`prob`.`updatedDate`,'%d %b %Y') AS `updatedDate`,`prob`.`problemID` AS `problemID`,7 AS `7`,`uorg`.`userID` AS `userID` from (`problem` `prob` join `userorganisation` `uorg` on((`prob`.`organisationID` = `uorg`.`organisationID`))) where (`prob`.`updatedDate` > `fn_past_date`(-(20))) order by `column4`,`problemName`,`column2` limit 40;

CREATE  VIEW `vw_select_project_detail_sidebar` AS select 'Created:' AS `description`,date_format(`proj`.`createdDate`,'%d %b %Y') AS `column2`,'' AS `id`,0 AS `column4`,`proj`.`projectID` AS `projectID` from `project` `proj` union select 'Last changed:' AS `description`,date_format(`proj`.`updatedDate`,'%d %b %Y') AS `column2`,'' AS `id`,3 AS `column4`,`proj`.`projectID` AS `projectID` from `project` `proj` union select 'Project tasks' AS `description`,'' AS `column2`,'' AS `id`,5 AS `column4`,0 AS `projectID` union select `proj`.`projectName` AS `description`,concat('Created: ',date_format(`proj`.`createdDate`,'%d %b %Y')) AS `column2`,`proj`.`projectID` AS `id`,7 AS `column4`,`proj`.`projectID` AS `projectID` from (`project` `proj` join `tasklist` `tsk` on((`proj`.`projectID` = `tsk`.`projectID`))) order by `column4` limit 40;

CREATE  VIEW `vw_select_project_index_sidebar` AS select 'New projects' AS `projectName`,'' AS `column2`,'' AS `id`,0 AS `column4`,'' AS `userID`,'1900-01-01 00:00:00:000' AS `dateorder` union select distinct `proj`.`projectName` AS `projectName`,`proj`.`createdDate` AS `createdDate`,`proj`.`projectID` AS `projectID`,3 AS `column4`,`upr`.`userID` AS `userID`,`proj`.`createdDate` AS `dateorder` from (`project` `proj` join `userproject` `upr` on((`proj`.`projectID` = `upr`.`projectID`))) where (`proj`.`createdDate` > `FN_PAST_DATE`(-(10))) union select 'Changed projects' AS `projectName`,'' AS `column2`,'' AS `id`,5 AS `column4`,'' AS `userID`,'1900-01-01 00:00:00:000' AS `dateorder` union select `proj`.`projectName` AS `projectName`,`proj`.`updatedDate` AS `updatedDate`,`proj`.`projectID` AS `projectID`,7 AS `column4`,`upr`.`userID` AS `userID`,`proj`.`updatedDate` AS `dateorder` from (`project` `proj` join `userproject` `upr` on((`proj`.`projectID` = `upr`.`projectID`))) where (`proj`.`updatedDate` > `FN_PAST_DATE`(-(10))) union select 'New users' AS `New users`,'' AS `column2`,'' AS `id`,9 AS `column4`,'' AS `userID`,'1900-01-01 00:00:00:000' AS `dateorder` union select `proj`.`projectName` AS `projectName`,`usr`.`username` AS `column2`,`proj`.`projectID` AS `projectID`,11 AS `column4`,`upr2`.`userID` AS `userID`,`usr`.`created_on` AS `dateorder` from (((`project` `proj` left join `userproject` `upr` on((`proj`.`projectID` = `upr`.`projectID`))) join `users` `usr` on((`upr`.`userID` = `usr`.`id`))) join `userproject` `upr2` on((`proj`.`projectID` = `upr2`.`projectID`))) where (`usr`.`created_on` > `FN_PAST_DATE`(-(10))) union select 'New tasklists' AS `New tasklists`,'' AS `column2`,'' AS `id`,13 AS `column4`,'' AS `userID`,'1900-01-01 00:00:00:000' AS `dateorder` union select `proj`.`projectName` AS `projectName`,`tsk`.`taskListName` AS `taskListName`,`proj`.`projectID` AS `projectID`,15 AS `column4`,`upr`.`userID` AS `userID`,`tsk`.`createdDate` AS `dateorder` from ((`project` `proj` join `userproject` `upr` on((`proj`.`projectID` = `upr`.`projectID`))) join `tasklist` `tsk` on((`tsk`.`projectID` = `proj`.`projectID`))) where (`tsk`.`createdDate` > `FN_PAST_DATE`(-(10))) order by `column4`,`dateorder` desc limit 40;

CREATE  VIEW `vw_select_task_detail_sidebar` AS select 'Created:' AS `description`,date_format(`tsk`.`createdDate`,'%d %b %Y') AS `column2`,'' AS `id`,0 AS `column4`,`tsk`.`taskID` AS `taskID` from `task` `tsk` union select 'Last changed:' AS `description`,date_format(`tsk`.`updatedDate`,'%d %b %Y') AS `column2`,'' AS `id`,3 AS `column4`,`tsk`.`taskID` AS `taskID` from `task` `tsk` union select 'Task activity' AS `Task activity`,'' AS `column2`,'' AS `id`,13 AS `13`,'' AS `taskID` union select concat('Comment: ',left(`comment`.`commentText`,20),'...') AS `Comment`,date_format(`comment`.`createdDate`,'%d %b %Y') AS `createdDate`,`comment`.`commentID` AS `commentID`,15 AS `15`,`tsk`.`taskID` AS `taskID` from ((`comment` join `task` `tsk` on((`comment`.`parentID` = `tsk`.`taskID`))) join `lookup` `lk` on(((`lk`.`lookupSubTypeID` = `comment`.`commentTypeID`) and (`lk`.`lookupTypeID` = 6)))) order by `column4` limit 40;

CREATE  VIEW `vw_select_task_index_sidebar` AS select 'New tasks' AS `taskDescription`,'' AS `column2`,'' AS `id`,0 AS `column4`,'' AS `userID` union select distinct `task`.`taskDescription` AS `taskDescription`,date_format(`task`.`createdDate`,'%d %b %Y') AS `createdDate`,`task`.`taskID` AS `taskID`,3 AS `3`,`upr`.`userID` AS `userID` from ((`task` join `tasklist` `tkl` on((`task`.`taskListID` = `tkl`.`taskListID`))) join `userproject` `upr` on((`upr`.`projectID` = `tkl`.`projectID`))) where (`task`.`createdDate` > `fn_past_date`(-(10))) union select 'Changed tasks' AS `Changed tasks`,'' AS `column2`,'' AS `id`,5 AS `5`,'' AS `userID` union select `task`.`taskDescription` AS `taskDescription`,date_format(`task`.`updatedDate`,'%d %b %Y') AS `updatedDate`,`task`.`taskID` AS `taskID`,7 AS `7`,`upr`.`userID` AS `userID` from ((`task` join `tasklist` `tkl` on((`task`.`taskListID` = `tkl`.`taskListID`))) join `userproject` `upr` on((`upr`.`projectID` = `tkl`.`projectID`))) where (`task`.`updatedDate` > `fn_past_date`(-(10))) union select 'New comments' AS `New comments`,'' AS `column2`,'' AS `id`,9 AS `9`,'' AS `userID` union select 'Comment' AS `Comment`,concat(`users`.`first_name`,' ',`users`.`last_name`) AS `createdBy`,`task`.`taskID` AS `taskID`,11 AS `11`,`upr`.`userID` AS `userID` from ((((`task` join `tasklist` `tkl` on((`task`.`taskListID` = `tkl`.`taskListID`))) join `userproject` `upr` on((`tkl`.`projectID` = `upr`.`projectID`))) join `comment` on((`comment`.`parentID` = `task`.`taskID`))) join `users` on((`users`.`id` = `upr`.`userID`))) where (`comment`.`createdDate` > `fn_past_date`(-(10))) order by `column4`,`taskDescription`,`column2` limit 40;

CREATE  VIEW `vw_select_time_detail_sidebar` AS select 'Created:' AS `description`,date_format(`usr`.`created_on`,'%d %b %Y') AS `column2`,'' AS `id`,0 AS `column4`,`usr`.`id` AS `userID` from `users` `usr` union select 'Last login:' AS `description`,date_format(from_unixtime(`usr`.`last_login`),'%d %b %Y') AS `column2`,'' AS `id`,3 AS `column4`,`usr`.`id` AS `userID` from `users` `usr` order by `column4` limit 40;

CREATE  VIEW `vw_select_time_index_sidebar` AS select 'My time by project' AS `projectName`,'' AS `column2`,'' AS `id`,0 AS `column4`,'' AS `userID` union select `prj`.`projectName` AS `projectName`,sum(`tme`.`hours`) AS `sum(tme.hours)`,`prj`.`projectID` AS `projectID`,3 AS `column4`,`uorg2`.`userID` AS `userID` from (((((`time` `tme` join `userorganisation` `uorg` on((`tme`.`userID` = `uorg`.`userID`))) join `task` `tsk` on((`tsk`.`taskID` = `tme`.`taskID`))) join `tasklist` `tkl` on((`tkl`.`taskListID` = `tsk`.`taskListID`))) join `project` `prj` on((`prj`.`projectID` = `tkl`.`projectID`))) join `userorganisation` `uorg2` on((`uorg`.`organisationID` = `uorg2`.`organisationID`))) where (`tme`.`createdDate` > `fn_past_date`(-(90))) group by `prj`.`projectID`,`prj`.`projectName`,`prj`.`projectID` union select 'My time this week' AS `My time this week`,'' AS `column2`,'' AS `id`,5 AS `5`,'' AS `userID` union select `prj`.`projectName` AS `projectName`,sum(`tme`.`hours`) AS `sum(tme.hours)`,`prj`.`projectID` AS `projectID`,3 AS `column4`,`uorg2`.`userID` AS `userID` from (((((`time` `tme` join `userorganisation` `uorg` on((`tme`.`userID` = `uorg`.`userID`))) join `task` `tsk` on((`tsk`.`taskID` = `tme`.`taskID`))) join `tasklist` `tkl` on((`tkl`.`taskListID` = `tsk`.`taskListID`))) join `project` `prj` on((`prj`.`projectID` = `tkl`.`projectID`))) join `userorganisation` `uorg2` on((`uorg`.`organisationID` = `uorg2`.`organisationID`))) where (`tme`.`createdDate` > `fn_past_date`(-(5))) group by `prj`.`projectID`,`prj`.`projectName`,`prj`.`projectID` union select 'My time this month' AS `My time this month`,'' AS `column2`,'' AS `id`,9 AS `9`,'' AS `userID` union select `prj`.`projectName` AS `projectName`,sum(`tme`.`hours`) AS `sum(tme.hours)`,`prj`.`projectID` AS `projectID`,3 AS `column4`,`uorg2`.`userID` AS `userID` from (((((`time` `tme` join `userorganisation` `uorg` on((`tme`.`userID` = `uorg`.`userID`))) join `task` `tsk` on((`tsk`.`taskID` = `tme`.`taskID`))) join `tasklist` `tkl` on((`tkl`.`taskListID` = `tsk`.`taskListID`))) join `project` `prj` on((`prj`.`projectID` = `tkl`.`projectID`))) join `userorganisation` `uorg2` on((`uorg`.`organisationID` = `uorg2`.`organisationID`))) where (`tme`.`createdDate` > `fn_past_date`(-(30))) group by `prj`.`projectID`,`prj`.`projectName`,`prj`.`projectID` order by `column4`,`projectName`,`column2` limit 40;

CREATE  VIEW `vw_select_user_detail_sidebar` AS select 'Created:' AS `description`,date_format(from_unixtime(`usr`.`created_on`),'%d %b %Y') AS `column2`,'' AS `id`,0 AS `column4`,`usr`.`id` AS `userID` from `users` `usr` union select 'Last login:' AS `description`,date_format(from_unixtime(`usr`.`last_login`),'%d %b %Y') AS `column2`,'' AS `id`,3 AS `column4`,`usr`.`id` AS `userID` from `users` `usr` order by `column4` limit 40;

CREATE  VIEW `vw_select_user_index_sidebar` AS select 'New users' AS `userName`,'' AS `column2`,'' AS `id`,0 AS `column4`,'' AS `userID` union select distinct `usr`.`username` AS `username`,date_format(from_unixtime(`usr`.`created_on`),'%d %b %Y') AS `created_on`,`usr`.`id` AS `id`,3 AS `3`,`uorg2`.`userID` AS `userID` from ((`users` `usr` join `userorganisation` `uorg` on((`usr`.`id` = `uorg`.`userID`))) join `userorganisation` `uorg2` on((`uorg`.`organisationID` = `uorg2`.`organisationID`))) where (`usr`.`created_on` > `fn_past_date`(-(90))) union select 'Changed users' AS `Changed users`,'' AS `column2`,'' AS `id`,5 AS `5`,'' AS `userID` union select distinct `usr`.`username` AS `username`,date_format(from_unixtime(`usr`.`created_on`),'%d %b %Y') AS `created_on`,`usr`.`id` AS `id`,3 AS `3`,`uorg`.`userID` AS `userID` from ((`users` `usr` join `userorganisation` `uorg` on((`usr`.`id` = `uorg`.`userID`))) join `userorganisation` `uorg2` on((`uorg`.`organisationID` = `uorg2`.`organisationID`))) where (`usr`.`last_login` > `fn_past_date`(-(90))) order by `column4`,`userName`,`column2` limit 40;
